# Desafio Dynadok - API de Gerenciamento de Clientes

## Sobre a aplicaÃ§Ã£o

Esta aplicaÃ§Ã£o Ã© uma API REST para cadastro, consulta, atualizaÃ§Ã£o e remoÃ§Ã£o de clientes, utilizando MongoDB, Redis para cache e RabbitMQ para mensageria. O projeto inclui um worker que consome mensagens da fila de clientes.

---

**ObservaÃ§Ã£o:**
As variÃ¡veis de ambiente necessÃ¡rias para rodar localmente estÃ£o no arquivo `.env.example` dentro da pasta `api`.

---

## InstruÃ§Ãµes para rodar a aplicaÃ§Ã£o com Docker

Execute o comando abaixo na raiz do projeto para subir todos os containers (API, MongoDB, Redis, RabbitMQ e Worker):

1. ```sh
   docker-compose up --build
   ```

---

## Usando a API (sem Docker)

1. Na pasta `api`, crie uma cÃ³pia do arquivo **.env.example** com o nome **.env** e ajuste as variÃ¡veis se necessÃ¡rio.
2. Instale as dependÃªncias:

   ```sh
   npm install
   ```
3. Inicie a aplicaÃ§Ã£o:

   ```sh
   npm run dev
   ```

   Isso irÃ¡ executar o **nodemon** e subir a aplicaÃ§Ã£o em modo de desenvolvimento.

---

## ğŸ“„ DocumentaÃ§Ã£o da API (Swagger)

A documentaÃ§Ã£o interativa da API estÃ¡ disponÃ­vel via Swagger.

### Como acessar

ApÃ³s subir a aplicaÃ§Ã£o (localmente ou via Docker), acesse:

```
http://localhost:3001/api/docs
```

LÃ¡ vocÃª pode visualizar todos os endpoints, parÃ¢metros, exemplos de requisiÃ§Ã£o e resposta, alÃ©m de testar as rotas diretamente pelo navegador.

### Como funciona

- A documentaÃ§Ã£o Ã© gerada automaticamente a partir dos comentÃ¡rios no cÃ³digo das rotas usando o [swagger-jsdoc](https://github.com/Surnet/swagger-jsdoc) e exibida com o [swagger-ui-express](https://github.com/scottie1984/swagger-ui-express).
- Sempre que vocÃª atualizar ou criar novas rotas, basta documentÃ¡-las com os comentÃ¡rios no padrÃ£o Swagger/OpenAPI.

---

## EndereÃ§o da aplicaÃ§Ã£o

- API disponÃ­vel em: [http://localhost:3001](http://localhost:3001)

---

## Rotas principais da aplicaÃ§Ã£o

### POST `/api/clients`

- Cria um novo cliente.

**Exemplo de requisiÃ§Ã£o:**

```json
{
  "name": "JoÃ£o Silva",
  "email": "joao@email.com",
  "phone": "11999999999"
}
```

**Exemplo de resposta:**

```json
{
  "name": "JoÃ£o Silva",
  "email": "joao@email.com",
  "phone": "11999999999",
  "id": "665f3c2b2b7e4e001e8e8e8e",
  "createdAt": "2024-06-16T18:00:00.000Z",
  "updatedAt": "2024-06-16T18:00:00.000Z"
}
```

---

### GET `/api/clients`

- Lista todos os clientes cadastrados.

---

### GET `/api/clients/{id}`

- Busca um cliente pelo ID.

---

### PUT `/api/clients/{id}`

- Atualiza os dados de um cliente.

---

### DELETE `/api/clients/{id}`

- Remove um cliente pelo ID.

---

## Arquitetura e Tecnologias

- **Express** (API REST)
- **Typescript**
- **MongoDB** (persistÃªncia)
- **Redis** (cache)
- **RabbitMQ** (mensageria)
- **Swagger** (documentaÃ§Ã£o)
- **Docker** (containerizaÃ§Ã£o)

---

## Worker RabbitMQ

O projeto inclui um worker (pasta `worker_rabbitmq`) que consome mensagens da fila `clients` do RabbitMQ e processa eventos de criaÃ§Ã£o, atualizaÃ§Ã£o, consulta e remoÃ§Ã£o de clientes.

## Como rodar o Worker RabbitMQ localmente (sem Docker)

1. Certifique-se de que o RabbitMQ estÃ¡ rodando em sua mÃ¡quina (pode ser via Docker ou instalado localmente).

   - Exemplo com Docker:
     ```sh
     docker run -d --name rabbitmq -p 5672:5672 -p 15672:15672 rabbitmq:3-management
     ```
   - O painel de administraÃ§Ã£o ficarÃ¡ disponÃ­vel em [http://localhost:15672](http://localhost:15672) (usuÃ¡rio/senha padrÃ£o: guest/guest).
2. Na pasta `worker_rabbitmq`, crie um arquivo `.env`  ou copie de `.env.example` com o conteÃºdo:

   ```
   RABBITMQ_URL=amqp://localhost
   ```
3. Instale as dependÃªncias do worker:

   ```sh
   cd worker_rabbitmq
   npm install
   ```
4. Compile o TypeScript:

   ```sh
   npm run build
   ```
5. Inicie o worker:

   ```sh
   npm start
   ```

> O worker irÃ¡ consumir e processar as mensagens da fila de clientes do RabbitMQ normalmente.
